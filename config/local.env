# Local development configuration (Docker Compose)
# This file contains ONLY local-specific overrides.
# Shared defaults are in base.env (loaded first by docker-compose).

# =============================================================================
# ENVIRONMENT IDENTIFIER
# =============================================================================

TM_ENV=local

# =============================================================================
# S3-COMPATIBLE STORAGE (MinIO)
# =============================================================================

TM_S3_ENDPOINT=http://minio:9000
TM_S3_ACCESS_KEY=minioadmin
TM_S3_SECRET_KEY=minioadmin
TM_S3_FORCE_PATH_STYLE=true

# =============================================================================
# ICEBERG CATALOG (REST catalog for local development)
# =============================================================================
# Todo: learn more about the iceberg schemas

TM_ICEBERG_CATALOG_TYPE=rest
TM_ICEBERG_REST_URI=http://iceberg-rest:8181

# =============================================================================
# LOCAL INPUT DIRECTORY
# =============================================================================
# Todo: local input like data source?

TM_LOCAL_INPUT_DIR=/opt/tagmarshal/input

# =============================================================================
# POSTGRESQL (for Airflow metadata DB)
# =============================================================================
# Todo: investigate metadata db

TM_POSTGRES_USER=airflow
TM_POSTGRES_PASSWORD=airflow
TM_POSTGRES_DB=airflow

# =============================================================================
# AIRFLOW ADMIN CREDENTIALS
# =============================================================================

TM_AIRFLOW_ADMIN_USERNAME=admin
TM_AIRFLOW_ADMIN_PASSWORD=admin
TM_AIRFLOW_ADMIN_EMAIL=admin@example.com

# =============================================================================
# SPARK CONFIGURATION (local development - conservative settings)
# =============================================================================
# These settings are tuned for laptop development (limited CPU/memory).
# AWS environment has more aggressive settings for cluster execution.
#
# Spark master mode:
#   - "local[N]": Run locally with N threads (good for laptops)
#   - "spark://host:7077": Standalone cluster (for distributed local testing)
#   - "yarn": AWS EMR (production)

TM_SPARK_MASTER=local[2]
TM_SPARK_DRIVER_MEMORY=1g
TM_SPARK_EXECUTOR_MEMORY=1g
TM_SPARK_SHUFFLE_PARTITIONS=8
TM_SPARK_ADAPTIVE_ENABLED=true
TM_SPARK_UI_ENABLED=false

# =============================================================================
# PIPELINE EXECUTION MODE
# =============================================================================
# Pipeline execution mode:
#   - "sequential": Run jobs one at a time (faster on laptops due to less contention)
#   - "parallel": Run all jobs at once (faster on clusters with lots of resources)
# For local dev, sequential is often faster: 6 jobs x 30s = 3 min
# vs parallel: 6 jobs competing = 5-6 min each

TM_PIPELINE_MODE=sequential
